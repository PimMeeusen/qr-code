<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Maak een foto</title>
</head>
<body style="font-family: sans-serif; padding: 20px">

  <h2>Maak een foto</h2>

  <input
    id="cameraInput"
    type="file"
    accept="image/*"
    capture="environment"
  />

  <p id="status"></p>

  <script>
    // üîß BACKEND CONFIG
    const UPLOAD_URL =
      "https://qr-code-luyqfi8iv-pimmeeusens-projects.vercel.app/api/upload";
    const UPLOAD_TOKEN = "maak-iets-geheims-zoals-dit-123";

    // Optioneel: QR-id uit de URL (?id=locatie1)
    const qrId =
      new URLSearchParams(window.location.search).get("id") || "qr";

    const input = document.getElementById("cameraInput");
    const statusEl = document.getElementById("status");

    input.addEventListener("change", async () => {
      const file = input.files?.[0];
      if (!file) return;

      statusEl.textContent = "Uploaden‚Ä¶";

      const formData = new FormData();
      formData.append("file", file);
      formData.append("qrId", qrId);

      try {
        const response = await fetch(UPLOAD_URL, {
          method: "POST",
          headers: {
            "x-upload-token": UPLOAD_TOKEN
          },
          body: formData
        });

        if (!response.ok) {
          throw new Error("Upload failed");
        }

        statusEl.textContent = "‚úÖ Foto ge√ºpload!";
      } catch (err) {
        console.error(err);
        statusEl.textContent = "‚ùå Upload mislukt.";
      }
    });
  </script>

</body>
</html>
